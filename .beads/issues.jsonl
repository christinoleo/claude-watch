{"id":"claude-watch-2ib","title":"Add batch-run types","description":"Create src/types/batch-run.ts with BatchRun, BatchRunTask interfaces","status":"closed","priority":1,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T09:25:46.321823071+01:00","created_by":"Leonardo","updated_at":"2026-02-06T09:27:43.733961011+01:00","closed_at":"2026-02-06T09:27:43.733961011+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-watch-2ib","depends_on_id":"claude-watch-oht","type":"blocks","created_at":"2026-02-06T09:25:54.563045398+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-2su","title":"Integrate batch run into EpicSection and BeadsPanel","description":"Add Batch Run button to EpicSection header, pass session context from BeadsPanel","status":"closed","priority":1,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T09:25:47.149666243+01:00","created_by":"Leonardo","updated_at":"2026-02-06T09:31:58.745765493+01:00","closed_at":"2026-02-06T09:31:58.745765493+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-watch-2su","depends_on_id":"claude-watch-oht","type":"blocks","created_at":"2026-02-06T09:25:55.699411645+01:00","created_by":"Leonardo"},{"issue_id":"claude-watch-2su","depends_on_id":"claude-watch-j27","type":"blocks","created_at":"2026-02-06T09:25:56.665310416+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-31k","title":"Multi-agent architecture","description":"Enable multiple claude-watch agents to work together, with a single UI aggregating sessions from all agents.\n\n## Goals\n- Agents can run independently on different machines\n- Browser can connect to multiple agents\n- Optional federation via webhooks between agents\n- Static site deployment option\n\n## Key Components\n- Agent-to-agent webhook communication\n- Workspace field in session JSON\n- Static site build option\n- Agent discovery/configuration","status":"open","priority":0,"issue_type":"epic","owner":"leomilho@gmail.com","created_at":"2026-01-28T18:38:52.868478755+01:00","created_by":"Leonardo","updated_at":"2026-01-28T18:38:52.868478755+01:00","dependencies":[{"issue_id":"claude-watch-31k","depends_on_id":"claude-watch-d7j","type":"blocks","created_at":"2026-01-28T18:40:37.127661584+01:00","created_by":"Leonardo"},{"issue_id":"claude-watch-31k","depends_on_id":"claude-watch-j0k","type":"blocks","created_at":"2026-01-28T18:40:37.2425277+01:00","created_by":"Leonardo"},{"issue_id":"claude-watch-31k","depends_on_id":"claude-watch-uir","type":"blocks","created_at":"2026-01-28T18:40:37.355944877+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-32b","title":"Phase 1: In-process planning orchestrator","description":"Create a custom agent or skill that automates the post-plan steps of Phase 1.\n\nAfter the human signals the plan is ready, this runs sequentially:\n1. /replan — score plan against original requirements\n2. /plan-to-beads — convert plan into epic + tasks\n3. Verify beads vs plan — like /replan but checking the beads captured everything from the plan\n4. bd sync — persist\n\nCould be a .claude/agents/ definition or a .claude/skills/ skill. Needs access to: Skill tool (for /replan, /plan-to-beads), Bash (for bd commands), Read (for plan file).\n\nOpen question: should this be a skill the user invokes (/finalize-plan?) or a custom agent the user spawns?","status":"open","priority":2,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T13:28:11.493079151+01:00","created_by":"Leonardo","updated_at":"2026-02-06T13:28:11.493079151+01:00","dependencies":[{"issue_id":"claude-watch-32b","depends_on_id":"claude-watch-8kn","type":"blocks","created_at":"2026-02-06T13:28:35.623289366+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-6co","title":"Implement BatchRunManager","description":"Server-side orchestrator in src/server/batch-run.ts. Monitors session state, sends task prompts via tmux, advances through beads tasks. ~200 lines.","status":"closed","priority":1,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T09:25:46.499471449+01:00","created_by":"Leonardo","updated_at":"2026-02-06T09:29:00.619612958+01:00","closed_at":"2026-02-06T09:29:00.619612958+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-watch-6co","depends_on_id":"claude-watch-oht","type":"blocks","created_at":"2026-02-06T09:25:54.764098177+01:00","created_by":"Leonardo"},{"issue_id":"claude-watch-6co","depends_on_id":"claude-watch-2ib","type":"blocks","created_at":"2026-02-06T09:25:55.907704349+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-6ip","title":"Test Epic: Add greeting utilities","description":"Add a simple greeting utility module with tests. This is a dummy epic for testing orchestration.","status":"open","priority":2,"issue_type":"epic","owner":"leomilho@gmail.com","created_at":"2026-02-06T16:16:27.801765943+01:00","created_by":"Leonardo","updated_at":"2026-02-06T16:16:27.801765943+01:00"}
{"id":"claude-watch-7pz","title":"Create greet.ts module with hello() function","description":"Create src/utils/greet.ts that exports a hello(name: string) function returning 'Hello, {name}\\!'. Keep it simple.","status":"closed","priority":2,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T16:16:37.773686502+01:00","created_by":"Leonardo","updated_at":"2026-02-06T16:33:27.117147633+01:00","closed_at":"2026-02-06T16:33:27.117147633+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-watch-7pz","depends_on_id":"claude-watch-6ip","type":"parent-child","created_at":"2026-02-06T16:18:29.306054883+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-8kn","title":"Orchestrator Harness: Two-Phase Workflow","description":"# Orchestrator Harness\n\nReplaces the current batch-run prototype with a proper two-phase orchestration system built around claude-watch CLI commands and native Claude Code skills.\n\n## Architecture\n\n**Orchestrator** = a Claude Code session (custom agent) that controls a **Worker** = another Claude Code session spawned via claude-watch. Communication via tmux (claude-watch CLI), state via beads.\n\n## Phase 1: Planning Harness (in-process)\n\nRuns inside the current conversation. Human is in the loop until plan milestone, then automated:\n\n1. [Human] Discussion → Decision\n2. [Human] Write plan\n3. [Auto] /replan (score plan vs requirements)\n4. [Auto] /plan-to-beads (create epic + tasks from plan)\n5. [Auto] Verify beads vs plan (like /replan but against beads)\n6. [Auto] bd sync\n\nTrigger: user signals plan is ready, agent runs steps 3-6 automatically.\n\n## Phase 2: Execution Harness (orchestrator + worker)\n\nFully automated. User starts it and comes back at the end.\n\n1. Orchestrator picks batch (agent decides size from complexity + dependency graph via bd ready)\n2. Orchestrator sends tasks to worker session via claude-watch CLI\n3. Worker executes tasks one at a time, closing beads issues\n4. Orchestrator detects completion via claude-watch wait-idle + bd show\n5. After batch: orchestrator runs /linus on the git diff (in its own context)\n6. /linus finds issues → orchestrator creates fix tasks in beads → sends fixes to worker\n7. Repeat until epic complete\n8. Final: /linus (full review) + /verify (browser) + /triage (produces questions)\n9. [Human] Answer triage questions + manual verification\n\n## Key Design Decisions\n\n- **claude-watch CLI as bridge**: Orchestrator uses CLI commands (send, wait-idle, status, capture, session-new) instead of knowing tmux internals\n- **Beads as handoff mechanism**: Review results stored as beads notes, fix tasks created as beads issues. No parallel state system.\n- **Batch sizing**: Execute tasks 1-at-a-time, batch /linus review every 2-3 tasks. Agent decides based on what bd ready returns + task complexity.\n- **Skills run natively**: /linus, /verify, /triage run in the orchestrator session (real Claude Code), not via tmux injection.\n- **Phase 1 is in-process**: Same conversation, no separate session needed.\n- **Phase 2 orchestrator**: Custom agent (.claude/agents/epic-runner.md) or main session. TBD.\n\n## Replaces\n\nThe current batch-run prototype (src/server/batch-run.ts, BatchRunControls.svelte, etc.) should be removed once this is implemented.","status":"open","priority":1,"issue_type":"epic","owner":"leomilho@gmail.com","created_at":"2026-02-06T13:27:55.383880267+01:00","created_by":"Leonardo","updated_at":"2026-02-06T13:27:55.383880267+01:00"}
{"id":"claude-watch-bjg","title":"Add batch-run REST API routes","description":"POST/GET /api/batch-run and POST/GET/DELETE /api/batch-run/[id] for start/status/control","status":"closed","priority":1,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T09:25:46.639285431+01:00","created_by":"Leonardo","updated_at":"2026-02-06T09:29:53.100035971+01:00","closed_at":"2026-02-06T09:29:53.100035971+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-watch-bjg","depends_on_id":"claude-watch-oht","type":"blocks","created_at":"2026-02-06T09:25:54.996300064+01:00","created_by":"Leonardo"},{"issue_id":"claude-watch-bjg","depends_on_id":"claude-watch-6co","type":"blocks","created_at":"2026-02-06T09:25:56.098243772+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-bob","title":"claude-watch CLI commands","description":"Add CLI subcommands to claude-watch that expose session control primitives. These are the bridge the orchestrator agent uses to control worker sessions.\n\nCommands needed:\n- claude-watch send \u003ctarget\u003e \u003ctext\u003e — send prompt to session via tmux buffer paste\n- claude-watch wait-idle \u003ctarget\u003e [--timeout 300] — block until session state becomes idle (polls session JSON)\n- claude-watch status \u003ctarget\u003e — return session state as JSON (state, current_action, beads_enabled, etc.)\n- claude-watch capture \u003ctarget\u003e [--lines 100] — capture pane content via tmux capture-pane\n- claude-watch session-new --cwd \u003cpath\u003e — spin up new Claude Code session in detached tmux\n\nThese wrap existing functionality (API routes, tmux commands, session watcher) as CLI commands. The orchestrator agent calls them via Bash tool.","status":"open","priority":1,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T13:28:06.492941149+01:00","created_by":"Leonardo","updated_at":"2026-02-06T13:28:06.492941149+01:00","dependencies":[{"issue_id":"claude-watch-bob","depends_on_id":"claude-watch-8kn","type":"blocks","created_at":"2026-02-06T13:28:35.355955451+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-cts","title":"Beads as handoff mechanism","description":"Design and implement the pattern for using beads as the handoff/state mechanism between orchestrator steps.\n\nPatterns to implement:\n- After /linus review: bd update \u003ctaskId\u003e --notes \"Review: passed\" or \"Review: issues found: ...\"\n- When /linus finds issues: bd create --title \"Fix: \u003cissue\u003e\" --type bug --parent \u003cepicId\u003e\n- Batch history: bd update \u003cepicId\u003e --notes \"Batch 1 (tasks X,Y,Z): completed, review passed\"\n- Final review results: bd update \u003cepicId\u003e --notes \"Final /linus: ... Final /verify: ...\"\n\nGoal: when user comes back after Phase 2, bd show \u003cepicId\u003e tells the full story — what was done, what was reviewed, what needs attention.\n\nMay need bd CLI enhancements (appending to notes vs overwriting?). Check bd capabilities.","status":"open","priority":2,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T13:28:21.785354605+01:00","created_by":"Leonardo","updated_at":"2026-02-06T13:28:21.785354605+01:00","dependencies":[{"issue_id":"claude-watch-cts","depends_on_id":"claude-watch-8kn","type":"blocks","created_at":"2026-02-06T13:28:35.989415836+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-d7j","title":"Add workspace field to session JSON","description":"Add a 'workspace' field to session JSON files to support grouping sessions across distributed agents.\n\n## Details\n- Hook detects workspace (git root, explicit config, or cwd-based)\n- Field is optional for backward compatibility\n- UI uses workspace for grouping instead of path-prefix logic\n\n## Acceptance Criteria\n- [ ] Hook writes workspace field to JSON\n- [ ] Workspace detection: try git root, fall back to config/cwd\n- [ ] UI groups by workspace when available\n- [ ] Backward compatible with existing JSON files","status":"open","priority":0,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-01-28T18:39:04.432567407+01:00","created_by":"Leonardo","updated_at":"2026-01-28T18:39:04.432567407+01:00"}
{"id":"claude-watch-fud","title":"Add farewell() function to greet.ts","description":"Add a farewell(name: string) function to src/utils/greet.ts that returns 'Goodbye, {name}\\!'. Export it alongside hello().","status":"open","priority":2,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T16:16:37.94627726+01:00","created_by":"Leonardo","updated_at":"2026-02-06T16:16:37.94627726+01:00","dependencies":[{"issue_id":"claude-watch-fud","depends_on_id":"claude-watch-7pz","type":"blocks","created_at":"2026-02-06T16:16:46.652389279+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-gt0","title":"Wire BatchRunManager into hooks.server.ts","description":"Instantiate BatchRunManager and make it accessible to API routes","status":"closed","priority":1,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T09:25:46.82127486+01:00","created_by":"Leonardo","updated_at":"2026-02-06T09:29:53.278581523+01:00","closed_at":"2026-02-06T09:29:53.278581523+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-watch-gt0","depends_on_id":"claude-watch-oht","type":"blocks","created_at":"2026-02-06T09:25:55.21669465+01:00","created_by":"Leonardo"},{"issue_id":"claude-watch-gt0","depends_on_id":"claude-watch-6co","type":"blocks","created_at":"2026-02-06T09:25:56.270968625+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-iwy","title":"Phase 2: Epic runner orchestrator agent","description":"Create the Phase 2 orchestrator — a custom agent (.claude/agents/epic-runner.md) that autonomously works through a beads epic.\n\nFlow:\n1. Receive epic ID as input\n2. Spin up worker session via: claude-watch session-new --cwd \u003cproject\u003e\n3. Loop:\n   a. bd ready --parent \u003cepicId\u003e to get unblocked tasks\n   b. Decide batch size (2-3 tasks based on complexity/deps)\n   c. For each task in batch:\n      - Construct prompt from task title + description\n      - claude-watch send \u003cworker\u003e \"prompt\"\n      - claude-watch wait-idle \u003cworker\u003e\n      - bd show \u003ctaskId\u003e to verify closed\n      - If not closed: retry or flag\n   d. After batch: invoke /linus skill on git diff\n   e. If /linus finds issues: bd create fix tasks, send to worker\n   f. Continue until bd ready returns empty\n4. Final gates: /linus (full) → /verify (browser) → /triage (human questions)\n5. Present triage results to user for answers + manual verification\n\nKey: this agent runs as a real Claude Code session, so /linus /verify /triage work natively. Worker session is controlled via claude-watch CLI commands.\n\nDepends on: claude-watch CLI commands task.","status":"open","priority":1,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T13:28:17.888758233+01:00","created_by":"Leonardo","updated_at":"2026-02-06T13:28:17.888758233+01:00","dependencies":[{"issue_id":"claude-watch-iwy","depends_on_id":"claude-watch-8kn","type":"blocks","created_at":"2026-02-06T13:28:35.806611761+01:00","created_by":"Leonardo"},{"issue_id":"claude-watch-iwy","depends_on_id":"claude-watch-bob","type":"blocks","created_at":"2026-02-06T13:28:36.385240099+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-j0k","title":"Agent-to-agent webhook federation","description":"Enable agents to sync session state via webhooks for distributed deployments.\n\n## Architecture\n- Agent watches local JSON files (as now)\n- On change, POST webhook to configured remote agents\n- Remote agents update their state and push to connected browsers\n\n## Config\n```json\n{\n  \"sync_to\": [\"http://hub-agent:3456/api/webhook\"]\n}\n```\n\n## Acceptance Criteria\n- [ ] Agent config for remote agent URLs\n- [ ] Webhook endpoint to receive session updates\n- [ ] POST to remotes on local file change\n- [ ] Deduplication (don't echo back received updates)","status":"open","priority":0,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-01-28T18:39:17.420583312+01:00","created_by":"Leonardo","updated_at":"2026-01-28T18:39:17.420583312+01:00","dependencies":[{"issue_id":"claude-watch-j0k","depends_on_id":"claude-watch-d7j","type":"blocks","created_at":"2026-01-28T18:39:42.596599112+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-j27","title":"Add BatchRunControls UI component","description":"Svelte component showing batch run status, progress, pause/resume/stop controls","status":"closed","priority":1,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T09:25:46.989446907+01:00","created_by":"Leonardo","updated_at":"2026-02-06T09:31:58.715025065+01:00","closed_at":"2026-02-06T09:31:58.715025065+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-watch-j27","depends_on_id":"claude-watch-oht","type":"blocks","created_at":"2026-02-06T09:25:55.439827636+01:00","created_by":"Leonardo"},{"issue_id":"claude-watch-j27","depends_on_id":"claude-watch-bjg","type":"blocks","created_at":"2026-02-06T09:25:56.494194978+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-lg5","title":"Paste image from clipboard into input","description":"Allow pasting images from clipboard into the input box. Image gets uploaded to /tmp/claude-watch-uploads/, path included in message so Claude Code can read it.\n\n## User Flow\n1. Ctrl+V with image in clipboard\n2. Small square thumbnail appears inside input box\n3. User types text\n4. Enter sends: uploads image first, then sends text with path\n\n## Components\n\n### Frontend\n- Paste event handler on textarea\n- Thumbnail preview (small square with X to remove)\n- State for pending image blob\n- Upload before send\n\n### Backend\n- POST /api/files/upload endpoint\n- Saves to /tmp/claude-watch-uploads/\u003cuuid\u003e.\u003cext\u003e\n- Returns absolute path\n\n### Cleanup\n- Simple: files older than 24h or just rely on /tmp clearing on reboot\n\n## Out of Scope\n- Multiple images\n- Drag and drop\n- File path detection (blob only)\n- Fancy preview modal","status":"open","priority":2,"issue_type":"feature","owner":"leomilho@gmail.com","created_at":"2026-01-30T18:40:19.894427981+01:00","created_by":"Leonardo","updated_at":"2026-01-30T18:40:19.894427981+01:00"}
{"id":"claude-watch-oht","title":"Batch Run Mode prototype","status":"closed","priority":1,"issue_type":"epic","owner":"leomilho@gmail.com","created_at":"2026-02-06T09:25:34.775245934+01:00","created_by":"Leonardo","updated_at":"2026-02-06T09:33:42.282774774+01:00","closed_at":"2026-02-06T09:33:42.282774774+01:00","close_reason":"Closed"}
{"id":"claude-watch-ptg","title":"Remove old batch-run prototype","description":"Remove the old batch-run prototype code once the new orchestrator is implemented:\n- src/server/batch-run.ts\n- src/types/batch-run.ts\n- web/src/routes/api/batch-run/+server.ts\n- web/src/routes/api/batch-run/[id]/+server.ts\n- web/src/lib/components/BatchRunControls.svelte\n- Revert changes to EpicSection.svelte, BeadsPanel.svelte, SessionsSidebar.svelte\n\nLow priority — do this last after the new system is working.","status":"open","priority":4,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T13:28:26.890285594+01:00","created_by":"Leonardo","updated_at":"2026-02-06T13:28:26.890285594+01:00","dependencies":[{"issue_id":"claude-watch-ptg","depends_on_id":"claude-watch-8kn","type":"blocks","created_at":"2026-02-06T13:28:36.167197653+01:00","created_by":"Leonardo"},{"issue_id":"claude-watch-ptg","depends_on_id":"claude-watch-iwy","type":"blocks","created_at":"2026-02-06T13:28:36.675388153+01:00","created_by":"Leonardo"},{"issue_id":"claude-watch-ptg","depends_on_id":"claude-watch-32b","type":"blocks","created_at":"2026-02-06T13:28:36.813387427+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-sz3","title":"Write tests for greeting utilities","description":"Create tests/utils/greet.test.ts with vitest tests for hello() and farewell(). Test basic output, empty string, and special characters.","status":"open","priority":2,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-02-06T16:16:38.112520654+01:00","created_by":"Leonardo","updated_at":"2026-02-06T16:16:38.112520654+01:00","dependencies":[{"issue_id":"claude-watch-sz3","depends_on_id":"claude-watch-fud","type":"blocks","created_at":"2026-02-06T16:16:46.789142352+01:00","created_by":"Leonardo"}]}
{"id":"claude-watch-uir","title":"Static site build option","description":"Build SvelteKit app as static site that connects to agent(s) directly from browser.\n\n## Architecture\n- Static HTML/JS/CSS (deploy to GitHub Pages, CDN, etc.)\n- Browser connects WebSocket to configured agent URL(s)\n- No server-side rendering needed\n- Agent URLs configured in UI or query params\n\n## Challenges\n- CORS handling on agents\n- Mixed content (HTTPS site → HTTP agents)\n- Agent discovery UX\n\n## Acceptance Criteria\n- [ ] SvelteKit adapter-static build option\n- [ ] Agent URL configuration in browser\n- [ ] CORS headers on agent API\n- [ ] Works with single or multiple agents","status":"open","priority":0,"issue_type":"task","owner":"leomilho@gmail.com","created_at":"2026-01-28T18:39:29.833000453+01:00","created_by":"Leonardo","updated_at":"2026-01-28T18:39:29.833000453+01:00","dependencies":[{"issue_id":"claude-watch-uir","depends_on_id":"claude-watch-d7j","type":"blocks","created_at":"2026-01-28T18:39:42.741491482+01:00","created_by":"Leonardo"}]}
